<!DOCTYPE html>
<html>
<head>
    <title>Simple Test - Is anything visible?</title>
    <style>
        body { margin: 0; padding: 20px; background: #000; color: #fff; font-family: Arial; }
        canvas { background: #fff; border: 2px solid #f00; display: block; margin-top: 20px; }
        .controls { margin-bottom: 20px; }
        button { padding: 10px; margin: 5px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>Visibility Test for Assclown</h1>
    <div class="controls">
        <button onclick="testBasic()">Test Basic Drawing</button>
        <button onclick="testGrid()">Test Grid</button>
        <button onclick="test3D()">Test 3D</button>
        <button onclick="clearCanvas()">Clear</button>
    </div>
    <div id="info">Canvas size: <span id="size">loading...</span></div>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas size
        canvas.width = 800;
        canvas.height = 600;
        document.getElementById('size').textContent = `${canvas.width} x ${canvas.height}`;
        
        console.log('Canvas created:', canvas.width, 'x', canvas.height);
        
        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            console.log('Canvas cleared');
        }
        
        function testBasic() {
            console.log('Testing basic shapes...');
            clearCanvas();
            
            // Red square
            ctx.fillStyle = '#ff0000';
            ctx.fillRect(50, 50, 100, 100);
            console.log('Drew red square at 50,50');
            
            // Blue circle
            ctx.fillStyle = '#0000ff';
            ctx.beginPath();
            ctx.arc(300, 150, 50, 0, 2 * Math.PI);
            ctx.fill();
            console.log('Drew blue circle at 300,150');
            
            // Green line
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 5;
            ctx.beginPath();
            ctx.moveTo(100, 300);
            ctx.lineTo(400, 350);
            ctx.stroke();
            console.log('Drew green line');
            
            // Text
            ctx.fillStyle = '#000000';
            ctx.font = '20px Arial';
            ctx.fillText('Hello Assclown!', 200, 400);
            console.log('Drew text');
        }
        
        function testGrid() {
            console.log('Testing grid...');
            clearCanvas();
            
            ctx.strokeStyle = '#cccccc';
            ctx.lineWidth = 1;
            
            let linesDrawn = 0;
            
            // Vertical lines
            for (let x = 0; x <= canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
                linesDrawn++;
            }
            
            // Horizontal lines
            for (let y = 0; y <= canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
                linesDrawn++;
            }
            
            // Center marker
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            ctx.strokeStyle = '#ff0000';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX - 20, centerY);
            ctx.lineTo(centerX + 20, centerY);
            ctx.moveTo(centerX, centerY - 20);
            ctx.lineTo(centerX, centerY + 20);
            ctx.stroke();
            
            console.log(`Drew grid with ${linesDrawn} lines and center marker`);
        }
          function test3D() {
            console.log('Testing 3D projection...');
            clearCanvas();
            
            // Simple 3D camera - positioned BEHIND the grid looking FORWARD
            const camera = { x: 0, y: 200, z: 500 };  // Further back, higher up
            
            function project3D(x, y, z) {
                const dx = x - camera.x;
                const dy = y - camera.y;
                const dz = z - camera.z;
                
                console.log(`Projecting point (${x}, ${y}, ${z}) -> camera space (${dx}, ${dy}, ${dz})`);
                
                if (dz >= 0) {  // Point is behind camera
                    console.log('Point behind camera, skipping');
                    return null;
                }
                
                // Use negative dz since we want points in front of camera
                const scale = 300;
                const screenX = (dx * scale) / -dz;  // Negative dz for correct projection
                const screenY = -(dy * scale) / -dz;
                
                const result = {
                    x: screenX + canvas.width/2,
                    y: screenY + canvas.height/2
                };
                
                console.log(`Screen coordinates: (${result.x}, ${result.y})`);
                return result;
            }            
            ctx.strokeStyle = '#888888';
            ctx.lineWidth = 1;
            
            let linesDrawn = 0;
            
            // Draw 3D grid on XZ plane (Y=0) - grid points in NEGATIVE Z (in front of camera)
            for (let x = -200; x <= 200; x += 50) {
                const p1 = project3D(x, 0, -400);  // Far end of grid
                const p2 = project3D(x, 0, -100);  // Near end of grid
                console.log(`Grid line X=${x}: p1=`, p1, 'p2=', p2);
                if (p1 && p2) {
                    ctx.beginPath();
                    ctx.moveTo(p1.x, p1.y);
                    ctx.lineTo(p2.x, p2.y);
                    ctx.stroke();
                    linesDrawn++;
                }
            }
            
            for (let z = -400; z <= -100; z += 50) {
                const p1 = project3D(-200, 0, z);
                const p2 = project3D(200, 0, z);
                console.log(`Grid line Z=${z}: p1=`, p1, 'p2=', p2);
                if (p1 && p2) {
                    ctx.beginPath();
                    ctx.moveTo(p1.x, p1.y);
                    ctx.lineTo(p2.x, p2.y);
                    ctx.stroke();
                    linesDrawn++;
                }
            }
              // Origin marker - place it in front of camera
            const origin = project3D(0, 0, -200);  // Origin in front of camera
            if (origin) {
                // Big red circle
                ctx.fillStyle = '#ff0000';
                ctx.beginPath();
                ctx.arc(origin.x, origin.y, 12, 0, 2 * Math.PI);
                ctx.fill();
                
                // Yellow cross through center
                ctx.strokeStyle = '#ffff00';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(origin.x - 15, origin.y);
                ctx.lineTo(origin.x + 15, origin.y);
                ctx.moveTo(origin.x, origin.y - 15);
                ctx.lineTo(origin.x, origin.y + 15);
                ctx.stroke();
                
                console.log('Origin drawn at:', origin);
            } else {
                console.log('Origin not visible!');
            }
            
            // Also draw a center reference cross at canvas center
            ctx.strokeStyle = '#0000ff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(canvas.width/2 - 10, canvas.height/2);
            ctx.lineTo(canvas.width/2 + 10, canvas.height/2);
            ctx.moveTo(canvas.width/2, canvas.height/2 - 10);
            ctx.lineTo(canvas.width/2, canvas.height/2 + 10);
            ctx.stroke();
            
            console.log(`Drew 3D grid with ${linesDrawn} lines, origin at`, origin);
        }
        
        // Auto-run basic test on load
        setTimeout(testBasic, 500);
    </script>
</body>
</html>
