<!DOCTYPE html>
<html>
<head>
    <title>Babylon Grid Test</title>
    <script src="https://preview.babylonjs.com/babylon.js"></script>
    <style>
        html, body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #renderCanvas {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
        #debug {
            position: fixed;
            top: 10px;
            left: 10px;
            background: black;
            color: lime;
            padding: 10px;
            font-family: monospace;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="debug">Debug: Starting...</div>
    <canvas id="renderCanvas"></canvas>
    
    <script>
        const debugDiv = document.getElementById('debug');
        function debug(msg) {
            console.log(msg);
            debugDiv.innerHTML += '<br>' + msg;
        }
        
        debug('Babylon.js version: ' + (typeof BABYLON !== 'undefined' ? 'Loaded' : 'Failed to load'));
        
        if (typeof BABYLON === 'undefined') {
            debug('ERROR: Babylon.js failed to load from CDN');
        } else {
            const canvas = document.getElementById('renderCanvas');
            debug('Canvas element: ' + (canvas ? 'Found' : 'Not found'));
            
            const engine = new BABYLON.Engine(canvas, true);
            debug('Engine created');
            
            const scene = new BABYLON.Scene(engine);
            debug('Scene created');
            
            // Set background color
            scene.clearColor = new BABYLON.Color3(0.2, 0.2, 0.3);
            debug('Background set');            // Camera
            try {
                const camera = new BABYLON.ArcRotateCamera("camera", 0, Math.PI/3, 10, BABYLON.Vector3.Zero(), scene);
                debug('Camera object created');
                
                camera.setTarget(BABYLON.Vector3.Zero());
                debug('Camera target set');
                
                camera.attachControl(canvas);
                debug('Camera controls attached to canvas');
                
                camera.inputs.removeByType("ArcRotateCameraMouseWheelInput");
                debug('Removing default ArcRotateCameraPointersInput');
                camera.inputs.removeByType("ArcRotateCameraPointersInput");
                debug('Adding custom ArcRotateCameraPointersInput with inverted controls');
                const pointersInput = new BABYLON.ArcRotateCameraPointersInput();
                pointersInput.buttons = [1, 2, 0]; // Middle mouse for pan, right mouse for rotate
                camera.inputs.add(pointersInput);
                debug('Custom ArcRotateCameraPointersInput added successfully');
                debug('Camera controls inverted: panning with middle mouse button, rotating with right mouse button');
                
                // Light
                const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
                debug('Light created');
                
                // Test box
                const box = BABYLON.MeshBuilder.CreateBox("box", {size: 2}, scene);
                debug('Test box created');
                
                // Start rendering
                engine.runRenderLoop(() => {
                    scene.render();
                });
                debug('Render loop started - you should see a blue box now');
                
                window.addEventListener('resize', () => {
                    engine.resize();
                });
                debug('Resize listener added');
                
            } catch (error) {
                debug('ERROR: ' + error.message);
            }
        }
    </script>
</body>
</html>
